(this.webpackJsonpeditor=this.webpackJsonpeditor||[]).push([[0],{253:function(t,e,n){},258:function(t,e,n){"use strict";n.r(e);var a,r,i,c,o=n(0),s=n.n(o),u=n(22),l=n.n(u),d=n(289),b=n(19),h=n(2),f=function(t){t.top;var e=t.bottom,n=t.left,a=(t.right,t.height),r=t.scale,i=Object(o.useRef)(null);return Object(o.useEffect)((function(){b.i(i.current).call(b.a(r))})),Object(h.jsx)("g",{className:"axis x",ref:i,transform:"translate(".concat(n,", ").concat(a-e,")")})},j=function(t){var e=t.top,n=(t.bottom,t.left),a=(t.right,t.scale),r=Object(o.useRef)(null);return Object(o.useEffect)((function(){b.i(r.current).call(b.b(a))})),Object(h.jsx)("g",{className:"axis y",ref:r,transform:"translate(".concat(n,", ").concat(e,")")})},p=b.g(b.h),g=b.c(".2f"),v=function(t){var e=t.data,n=t.x,a=t.y,r=t.height,i=t.top,c=t.bottom,o=e.value;return Object(h.jsxs)("g",{transform:"translate(".concat(n(e.dayOfWeek),", ").concat(a(o),")"),children:[Object(h.jsx)("rect",{width:n.bandwidth(),height:r-c-i-a(o),fill:p(e.date)}),Object(h.jsx)("text",{transform:"translate(".concat(n.bandwidth()/2,", ").concat(-2,")"),textAnchor:"middle",alignmentBaseline:"baseline",fill:"grey",fontSize:"10",children:g(o)})]})},m=function(t){var e=30,n=t.data,a=b.e().range([0,t.width-e-0]).domain(n.map((function(t){return t.dayOfWeek}))).paddingInner(.1),r=b.f().range([t.height-20-e,0]).domain([0,b.d(n,(function(t){return t.value}))]);return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("svg",{width:t.width,height:t.height,children:[Object(h.jsx)(f,{scale:a,top:20,bottom:e,left:e,right:0,height:t.height}),Object(h.jsx)(j,{scale:r,top:20,bottom:e,left:e,right:0}),Object(h.jsx)("g",{transform:"translate(".concat(e,", ").concat(20,")"),children:n.map((function(n,i){return Object(h.jsx)(v,{data:n,x:a,y:r,top:20,bottom:e,height:t.height},n.date)}))})]})})},x={TodoListStore:Symbol.for("TodoListStore"),IndexedDBHelper:Symbol.for("IndexedDBHelper"),TodoListModel:Symbol.for("TodoListModel"),HistoryModel:Symbol.for("HistoryModel")},O=n(33),y=n(26),w=(n(245),n(59)),D=n(29),T=n(7),_=n.n(T),k=n(13),C=n(27),N=n(55),S=n(60),L=n(61),B=["\u0412\u0441","\u041f\u043d","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041f\u0442","\u0421\u0431"],H=function(t){return new Intl.DateTimeFormat("en-En",{year:"numeric",month:"numeric",day:"numeric"}).format(t)},A=n(14),M=Object(y.injectable)()(a=function t(){var e=this;Object(C.a)(this,t),this._dbName="todo",this._version=3,this._db=null,this.init=function(){var t=Object(k.a)(_.a.mark((function t(e){return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.remove=function(){var t=Object(k.a)(_.a.mark((function t(n,a){var r;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(r=e._db)||void 0===r?void 0:r.delete(n,a);case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.write=function(){var t=Object(k.a)(_.a.mark((function t(n,a){var r,i,c,o,s,u,l=arguments;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=l.length>2&&void 0!==l[2]&&l[2],null!==e._db){t.next=3;break}return t.abrupt("return",null);case 3:if(i=e._db.transaction([n],"readwrite"),c=i.objectStore(n),!r){t.next=8;break}return t.next=8,c.clear();case 8:o=Object(A.a)(a);try{for(o.s();!(s=o.n()).done;)u=s.value,c.put&&c.put(u)}catch(d){o.e(d)}finally{o.f()}return t.next=12,i.done;case 12:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.update=function(){var t=Object(k.a)(_.a.mark((function t(n,a){var r;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(r=e._db)||void 0===r?void 0:r.put(n,Object(D.a)({},a));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.getData=function(){var t=Object(k.a)(_.a.mark((function t(n){return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e._db){t.next=2;break}return t.abrupt("return",[]);case 2:return t.next=4,e._db.getAll(n);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})||a,I=function(t){Object(N.a)(n,t);var e=Object(S.a)(n);function n(){var t;Object(C.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r)))._dbName="history",t.init=function(){var e=Object(k.a)(_.a.mark((function e(n){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(L.a)(t._dbName,t._version,{upgrade:function(t,e,a,r){t.createObjectStore(n,{keyPath:"date"})}});case 2:t._db=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getDefaultHistoryRecord=function(t){return{value:0,date:H(t),dayOfWeek:B[t.getDay()]}},t.changeTaskStatus=function(){var e=Object(k.a)(_.a.mark((function e(n,a){var r,i,c,o,s;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new Date,e.next=3,null===(r=t._db)||void 0===r?void 0:r.get(n,H(c));case 3:void 0===(o=e.sent)&&(o=t.getDefaultHistoryRecord(c)),s=a?o.value+1:o.value-1,null===(i=t._db)||void 0===i||i.put(n,Object(D.a)(Object(D.a)({},o),{},{value:Math.max(s,0)}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.getNewDataArray=function(t,e){var n=Object(w.a)(t),a=n.findIndex((function(t){return t.date===H(new Date)})),r=n[a].value,i=e?r+1:r-1;return n[a].value=Math.max(i,0),n},t.createDataIfNotExists=function(){var e=Object(k.a)(_.a.mark((function e(n){var a,r,i,c,o,s;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new Date,r=0;case 2:if(!(r<B.length)){e.next=15;break}return(c=new Date).setDate(a.getDate()-r),o=H(c),e.next=8,null===(i=t._db)||void 0===i?void 0:i.get(n,o);case 8:if(void 0!==e.sent){e.next=12;break}return e.next=12,null===(s=t._db)||void 0===s?void 0:s.put(n,t.getDefaultHistoryRecord(c));case 12:r++,e.next=2;break;case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getAll=function(){var e=Object(k.a)(_.a.mark((function e(n){var a,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(a=t._db)||void 0===a?void 0:a.getAll(n);case 2:if(void 0!==(r=e.sent)){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",r.slice(-B.length));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t}return n}(M),E=Object(y.injectable)()(r=function(t){Object(N.a)(n,t);var e=Object(S.a)(n);function n(){var t;Object(C.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))).init=function(){var e=Object(k.a)(_.a.mark((function e(n){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(L.a)(t._dbName,t._version,{upgrade:function(t,e,a,r){t.createObjectStore(n,{keyPath:"id"})}});case 2:t._db=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t}return n}(M))||r,R=n(5);!function(t){t[t.All=0]="All",t[t.New=1]="New",t[t.Completed=2]="Completed"}(i||(i={}));var F=Object(y.injectable)()(c=function t(){var e=this;Object(C.a)(this,t),this.data=[],this.currentTab=i.All,this.tabularData=this.data,this.onCreating=!1,this.newTitle="",this._todoDB=void 0,this._historyDB=void 0,this.historyData=[],this._tableNameList="todolist",this._tableNameHistory="history",this.initDb=Object(k.a)(_.a.mark((function t(){var n,a,r,i;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([e._todoDB.init(e._tableNameList),e._historyDB.init(e._tableNameHistory)]);case 2:return t.next=4,e._historyDB.createDataIfNotExists(e._tableNameHistory);case 4:return t.next=6,Promise.all([e._todoDB.getData(e._tableNameList),e._historyDB.getAll(e._tableNameHistory)]);case 6:n=t.sent,a=Object(O.a)(n,2),r=a[0],i=a[1],e.data=r,e.historyData=i,e.onTabChange(e.currentTab);case 13:case"end":return t.stop()}}),t)}))),this.onTabChange=function(t){e.currentTab=t,t===i.All?e.tabularData=e.data:t===i.New?e.tabularData=e.data.filter((function(t){return!1===t.completed})):t===i.Completed&&(e.tabularData=e.data.filter((function(t){return!0===t.completed})))},this.onChangeCheckbox=function(t){return function(n,a){var r=e.data.findIndex((function(e){return e.id===t}));e.data[r].completed=a,e._todoDB.update(e._tableNameList,e.data[r]),e._historyDB.changeTaskStatus(e._tableNameHistory,a),e.onTabChange(e.currentTab),e.updateHistoryData(a)}},this.updateHistoryData=function(t){e.historyData=e._historyDB.getNewDataArray(e.historyData,t)},this.onTypingNewInput=function(t){e.newTitle=t},this.setCreating=function(t){e.onCreating=t},this.createNewTask=function(){var t={id:Math.max.apply(Math,Object(w.a)(e.data.map((function(t){return t.id}))))+1,completed:!1,title:e.newTitle};e.data.push(t),e.onTabChange(e.currentTab),e._todoDB.write(e._tableNameList,[t]),e.onCreating=!1,e.newTitle=""},this.removeTask=function(t){e.data=e.data.filter((function(e){return t!==e.id})),e._todoDB.remove(e._tableNameList,t),e.onTabChange(e.currentTab)},this.loadFile=function(t){e.data=t,e.onTabChange(e.currentTab);e._todoDB.write(e._tableNameList,t,!0)},this._todoDB=P.get(x.TodoListModel),this._historyDB=P.get(x.HistoryModel),Object(R.m)(this,{data:R.n,onChangeCheckbox:R.f,onTabChange:R.f,currentTab:R.n,tabularData:R.n,onCreating:R.n,createNewTask:R.f,setCreating:R.f,initDb:R.f,historyData:R.n,updateHistoryData:R.f}),this.initDb()})||c,P=new y.Container;function W(t){var e=Object(o.useState)((function(){return P.get(t)})),n=Object(O.a)(e,2),a=n[0];n[1];return a}P.bind(x.TodoListStore).to(F).inSingletonScope(),P.bind(x.HistoryModel).to(I).inSingletonScope(),P.bind(x.TodoListModel).to(E).inSingletonScope();var J=function(t){var e=W(x.TodoListStore);return Object(h.jsx)("div",{style:{marginTop:50},children:Object(h.jsx)("input",{type:"file",onChange:function(t){if(t.target.files&&0!==t.target.files.length){var n=t.target.files[0],a=new FileReader;a.addEventListener("load",(function(t){if(!t.target||!t.target.result)return!1;var n=JSON.parse(t.target.result);e.loadFile(n)})),a.readAsText(n)}}})})},z=n(282),q=n(290),G=n(28),K=Object(G.a)((function(){var t=W(x.TodoListStore);return Object(h.jsxs)(q.a,{value:t.currentTab,onChange:function(e,n){return t.onTabChange(n)},children:[Object(h.jsx)(z.a,{label:"\u0412\u0441\u0435"}),Object(h.jsx)(z.a,{label:"\u041d\u043e\u0432\u044b\u0435"}),Object(h.jsx)(z.a,{label:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435"})]})})),Q=n(292),U=n(283),V=Object(G.a)((function(){var t=W(x.TodoListStore),e=Object(h.jsxs)("div",{children:[Object(h.jsx)(Q.a,{onChange:function(e){return t.onTypingNewInput(e.target.value)}}),Object(h.jsxs)("div",{style:{marginTop:10},children:[Object(h.jsx)(U.a,{onClick:function(){return t.createNewTask()},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),Object(h.jsx)(U.a,{onClick:function(){return t.setCreating(!1)},children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"})]})]});return Object(h.jsxs)(h.Fragment,{children:[!t.onCreating&&Object(h.jsx)(U.a,{color:"secondary",variant:"contained",onClick:function(){return t.setCreating(!0)},children:"+"}),t.onCreating&&e]})})),X=n(287),Y=n(286),Z=n(291),$=n(284),tt=n(285),et=n(288),nt=n(124),at=n.n(nt),rt=(n(253),Object(G.a)((function(t){var e=W(x.TodoListStore);return Object(h.jsx)($.a,{children:e.tabularData.map((function(t,n){var a=t.completed;return Object(h.jsxs)(tt.a,{className:a?"success":"new",children:[Object(h.jsx)(Z.a,{checked:a,onChange:e.onChangeCheckbox(t.id)}),Object(h.jsx)(X.a,{primary:t.title}),Object(h.jsx)(et.a,{children:Object(h.jsx)(Y.a,{edge:"end",onClick:function(){return e.removeTask(t.id)},children:Object(h.jsx)(at.a,{})})})]},t.title)}))})}))),it=n(63),ct=Object(G.a)((function(){var t=W(x.TodoListStore);return Object(h.jsxs)(d.a,{container:!0,justify:"center",direction:"column",alignItems:"center",style:{maxWidth:1e3,marginLeft:"auto",marginRight:"auto"},children:[Object(h.jsx)(d.a,{item:!0,children:Object(h.jsx)(K,{})}),Object(h.jsx)(d.a,{item:!0,children:Object(h.jsx)(rt,{})}),Object(h.jsx)(d.a,{item:!0,children:Object(h.jsx)(V,{})}),t.currentTab===i.Completed&&Object(h.jsx)(d.a,{item:!0,children:Object(h.jsx)(m,{data:t.historyData,width:500,height:300})}),Object(h.jsxs)(d.a,{item:!0,style:{marginTop:40},children:[Object(h.jsxs)(it.a,{variant:"h5",component:"h5",children:["\u0414\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447 \u0438\u0437 \u0444\u0430\u0439\u043b\u0430, \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0435\u0433\u043e (\u0432\u0441\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0443\u0434\u0430\u043b\u044f\u0442\u0441\u044f)"," "]}),Object(h.jsx)(J,{})]})]})}));l.a.render(Object(h.jsx)(s.a.StrictMode,{children:Object(h.jsx)(ct,{})}),document.getElementById("root"))}},[[258,1,2]]]);
//# sourceMappingURL=main.422e3ea3.chunk.js.map